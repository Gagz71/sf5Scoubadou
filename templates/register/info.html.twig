{% extends 'base.html.twig' %}

{% block title %}D√©tails {% endblock %}

{% block body %}
    <div class="container-fluid">
        <div class="row">
            <div class="card" style="width: 18rem;">
                <h5 class="card-header">Mes infos personnelles</h5>
                <p class="card-text"><small class="text-muted">Compte cr√©e le {{ app.user.registerDate | date }}</small>
                </p>
                <div class="card-body">
                    {% if is_granted('ROLE_ADVERTISER') %}
                        <h5 class="card-title">Organisation</h5>
                        <p>{{ app.user.organizationName }}</p>
                        <p>{{ app.user.countAdverts }} annonces en
                            lignes</p>
                    {% endif %}
                    <h5 class="card-title">Nom</h5>
                    <p class="card-text">{{ app.user.lastname }}</p>
                    <h5 class="card-title">Pr√©nom</h5>
                    <p class="card-text">{{ app.user.firstname }}</p>
                    <h5 class="card-title">Email</h5>
                    <p class="card-text">{{ app.user.email }}</p>
                    <a href="{{ path('adopting_edit', {'id' : app.user.id}) }}" class="btn btn-warning">Modifier mes
                        infos</a>
                </div>
            </div>
            <div class="jumbotron">
                <div class="d-flex justify-content-between">

                    <h1 class="display-4">Mes demandes d'adoptions</h1>
                    <div class="">
                        <span class="badge badge-warning">{{ app.user.adoptingRequests.count }}</span>
                    </div>
                </div>
                <div class="row">
                {% for adoptingRequest in app.user.adoptingRequests %}

                        <div class="col-sm-6">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">{{ adoptingRequest.advert.title }}</h5>
                                    <p class="card-subtitle text-muted">Association: <b>{{ adoptingRequest.advert.advertiser.getOrganizationName() }}</b></p>
                                    <p class="card-title">{{ dump(adoptingRequest.dogs) }}</p>
{#                                    <p class="card-title">{{ adoptingRequest.dog }}</p>#}
                                    <hr class="my-4">
                                    <h5 class="card-title">üêï</h5>
                                    <ul class="list-group list-group-flush lead">
                                    {% for dog in adoptingRequest.dogs %}
                                        <li class="list-group-item">{{ dog.name }} üêæ  </li>
                                    {% endfor %}
                                    </ul>

                                    <div class="card-footer">

                                        <a class="btn btn-primary btn-lg" href="{{ path('discussions', {'id':adoptingRequest.id}) }}" role="button">voir mes messages</a>
                                        <div class="small">
                                            Statut: {{adoptingRequest.status == 0 ? 'Adopt√©' : ' En cours' }}
                                        </div>
                                        <div class="text">
                                            <a href="{{ path('advert', {'slug' : adoptingRequest.advert.slug}) }}"
                                               title="Voir l'annonce en d√©tail" class="btn btn-outline-info">En savoir plus</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                {% endfor %}
                </div>

            </div>
            {% if is_granted('ROLE_ADVERTISER') %}
            <div>
                <h2>Mes annonces</h2>
                <table class="table table-striped table-hover">
                    <thead>
                    {% for advert in app.user.adverts %}
                    <tr>
                        <th scope="col">Titre de l'annonce</th>
                        <th scope="col">Date de cr√©ation</th>
                        <th scope="col">Statut</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>{{ advert.title }}</td>
                        <td>{{ advert.creationDate | date}}</td>
                        <td>{{ advert.status }}</td>
                    </tr>
                    </tbody>
                    {% endfor %}
                </table>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}